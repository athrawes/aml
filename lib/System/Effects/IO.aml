Effect = use "System/Control/Effect"

module IO :> Effect =
  type Pending = _
  type Running = _
  type Complete<A> = value -> { value }

  type IO<A>:
    | Pending
    | Running
    | Complete<A>

  # @inheritdoc
  from = Complete

  # @inheritdoc
  then = self -> callback ->
    match self
    | Complete { value } -> callback value
    | Running -> todo!
    | Pending -> todo!
