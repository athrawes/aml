Effect = use "System/Control/Effect"

module Thread :> Effect =
  type Finished<A> = value -> { value }
  type Pending = _

  type Thread<A>:
    | Pending
    | Finished<A>

  # @inheritdoc
  from = Finished

  # @inheritdoc
  then = thread -> callback ->
    match thread
    | Finished { value } -> callback value
    | Pending -> todo!
